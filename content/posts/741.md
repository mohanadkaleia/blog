Title: Sending emails via PHP
Date: 2017-08-13 06:30
Author: mohanad
Category: Uncategorized
Slug: 741
Status: draft

السلام عليكم ورحمة الله وبركاته..

ربما علينا الأقرار اننا نعيش حالياً في عصر أصبح فيه التواصل الاجتماعي جزء لا يتجزئ من دقائق حياتنا اليومية، والذي هو انعكاس وتطبيق لمفهوم الجيل الثالث للانترنت حيث تم إغناء الساحة المعلوماتية بالمشاركة الاجتماعية بين البشر. وفي ظل هذا الازدحام الاجتماعي، تضائل الاعتماد على وسائل التواصل القديمة مثل الرسائل الالكترونية وتراجع دورها وغلب عليها الطابع الرسمي.  ومع ذلك لابد أن نحتاج لها حيث يعتبر البريد الالكتروني أحد وسائل التوثيق ووسيلة فعّالة لأرشفة الرسائل المهمة.

العديد من تطبيقات الويب تتطلب  أرسال رسائل الكترونية للمستخدمين، كنوع من التنبيهات أو لأرسال آخر المستجدات أو لأي سبب آخر، في هذه التدوينة سأقوم بشرح أبسط وأفضل طريقة وجدتها للتعامل مع أرسال الأيميلات من خلال لغة PHP

قبل أن أشرع في التفاصيل العملية، أودُّ أن أورد باختصار أساسيات  مخدّم البريد الألكتروني. يتكوّن خادم البريد الالكتروني  من بروتوكولين أساسين SMTP, POP3.حيث يقوم بروتوكول SMTP بأرسال الرسائل بينما بروتوكول POP3 باستقبالها. الصورة التالية توضح مخطط خادم البريد الالكتروني:

![](http://mohanadkaleia.com/wp-content/uploads/2017/08/Maile-system.png){.aligncenter .size-full .wp-image-744 width="400" height="329"}

حسناً،  بعيداً عن التفاصيل النظرية لنقم الآن بالبدء الخطوات العملية، لنتفق أولاً أن أي برنامج يقوم بإرسال أو استقبال الرسائل الألكترونية، سواء كان email client مثل Outlook أو Thunderbird، أو حتى موقع ويب مبني بأي لغة برمجة مثل PHP فأنه يحتاج إلى **خادم للبريد الالكترني** بحيث يقوم هذا البرنامج باستخدام الخادم لأرسال واستقبال الرسائل.

حسناً يأتي السؤال الطبيعي هنا، من أين آتي بخادم بريد؟!

يوجد لديك العديد من الخيارات، تبدأ من استخدام خادم البريد الخاص بغوغل smtp.gmail.com، أو إذا كان موقعك أو تطبيق الويب الخاص بك موجود على مخدمات استضافة فعادة ما يقومون بتزويدك بخادم. بالنسبة لي فقد استخدمت من قبل خادم بريد غوغل، ولكن لسبب ما لم أعد أستطيع استخدامه! لذلك كان علي أيجاد حل بديل، فما كان مني إلا أن قمت بتنصيب مخدم بريد مجاني وخفيف يقوم بالعمل المطلوب، وذلك ما سأقوم بشرحه بعد قليل. نسيت أن أقول أن هذا الشرح مخصص لأنظمة Microsoft Windows Server. يمكن تطبيق نفس الأفكار تماماً على أنظمة Linux.

[1. تنصيب خادم البريد hMailServer]{style="color: #ff6600;"} {#تنصيب-خادم-البريد-hmailserver dir="rtl"}
-----------------------------------------------------------

هو خادم بريد، مجاني، مفتوح المصدر وخفيف جداً على السيرفر. لن يتطلب منك مهارة في إدارة أي شي، المهارة المطلوبة لتنصيبه هي مهارة ضغط زر "التالي" "next" :)

يمكنك تحميله من الرابط التالي: https://www.hmailserver.com/

بعد أن تقوم بتنصيبه، يمكنك تغيير بعض الأعدادات مثل رقم المنفذ port الذي تريد أن تتصل عليه (الافتراضي SMTP 25).

عندما استخدمت هذا الخادم ظهر لي خطأ، ولكن لا أذكر ماهو :) ولكن أذكر كيفية الحل على الأقل :\]  ها هي

 - بعد أن تقوم بتنصيب الخادم، قم بفتح لوحة الأدارة hMail Aministration من قائمة أبداً

 - من الخيارات في القائمة اليسرى، قم باختيار advanced ثم ip ranges

 - ثم قم بألغاء تفعيل خيارات local to local أو local to external أو external to external (نعم ألغها كلها)

[2. ضبط أعدادات ملف PHP.ini ]{style="color: #ff6600;"} {#ضبط-أعدادات-ملف-php.ini dir="rtl"}
------------------------------------------------------

وصلنا نصف الطريق، قم بفتح ملف php.ini (لا تقل لي لا تعرف أين تجده! بزعل منك)، قم بالبحث عن mail function

وقم بالتعديلات الازمة أن لم تكن مضبوطة:
